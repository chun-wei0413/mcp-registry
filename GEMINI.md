# 專案名稱：MCP 伺服器 v2.1 - 即時學習與智慧檢索系統

**版本:** 2.1 (Pivoted)

---

## 1. 專案總覽 (Overview)

本專案旨在建立一個**實現了 MCP (Model Context Protocol) 的智慧檢索伺服器**。MCP 是一個專為 AI 客戶端（如 `gemini-cli`）設計的通訊協定，使其能夠與後端知識庫進行高效的互動。

與傳統的 RESTful API 不同，MCP 的設計完全專注於服務 AI，使其可以將在開發過程中產生的「知識點」即時儲存起來，並在需要時透過語意查詢或主題標籤，快速地找回最相關的上下文資訊。本伺服器即是 MCP 的一個具體實作。

## 2. 核心使用情境 (Core Scenarios)

系統圍繞著三個主要的 API 端點運作：`learn`, `search`, 和 `retrieve`。

### 情境一：即時學習 (`/learn`)

*   **觸發點：** 當開發者在 `gemini-cli` 的互動中，發現一個值得記錄的設計原則、程式碼片段或任何關鍵見解時。
*   **動作：** `gemini-cli` 向 `mcp-server` 的 `POST /learn` 端點發送一個請求，其中包含一個 `topic` (主題標籤) 和 `content` (知識內容)。
*   **結果：** 伺服器接收此知識點，將其內容轉換為向量，並連同其主題標籤一起存入 `ChromaDB` 向量資料庫中。系統的知識因此而不斷增長。

### 情境二：語意搜尋 (`/search`)

*   **觸發點：** 當開發者需要解決一個問題，並想從知識庫中尋找相關參考時。
*   **動作：** `gemini-cli` 向 `POST /search` 端點發送一個自然語言查詢 (`query`)。此查詢可以選擇性地附帶一個 `topic` 標籤，以將搜尋範圍縮小到特定主題內，從而提高搜尋的精準度。
*   **結果：** 伺服器執行語意搜尋，比對查詢與資料庫中知識點的語意相似度，並返回最相關的 `top-k` 個結果。

### 情境三：按主題提取 (`/retrieve`)

*   **觸發點：** 當開發者需要全面複習某個特定主題（例如 "SOLID" 或 "DDD"）的所有相關知識時。
*   **動作：** `gemini-cli` 向 `GET /retrieve` 端點發送請求，並透過查詢參數指定 `topic`。
*   **結果：** 伺服器不過濾語意，直接返回該 `topic` 下的所有知識點列表。

## 3. 架構演進

*   **從批次到即時：** 我們放棄了原先需要手動執行 `indexer.py` 來掃描 `.md` 檔案的批次處理模式。
*   **從靜態到動態：** 知識庫現在是動態的，可以隨時透過 `/learn` API 進行擴充，使其成為一個真正「活」的系統。
*   **更靈活的檢索：** 結合了「語意搜尋」和「主題過濾」兩種模式，讓使用者可以根據情境選擇最適合的檢索方式。
